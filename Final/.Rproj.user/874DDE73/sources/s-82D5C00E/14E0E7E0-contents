sb1_high_score <- max(single_beg1_df["High Score"], na.rm = TRUE)
sb1_fastest_time <- min(single_beg1_df["Average Time Taken per Round (sec)"], na.rm = TRUE)
sb1_most_rounds <- max(single_beg1_df["Number of Rounds Completed"], na.rm = TRUE)
sb1_average_score <- round(mean(single_beg1_df$`Average Score`, na.rm = TRUE), digits = 2)
sb1_average_time <- round(mean(single_beg1_df$`Average Time Taken per Round (sec)`, na.rm = TRUE), digits = 2)
sb1_average_rounds <- round(mean(single_beg1_df$`Number of Rounds Completed`, na.rm = TRUE), digits = 2)
sb1_best_accuracy <- max(single_beg1_df$`Accuracy Percentage`, na.rm = TRUE)
sb1_average_accuracy <- round(mean(single_beg1_df$`Accuracy Percentage`, na.rm = TRUE), digits = 2)

# sb1_table_shown <- subset(single_beg1_df, select = -c(4, 5))
# sb1_table_shown <- subset(single_beg1_df, select = c(1, 2, 3, 7, 11, 10, 6, 8, 9))
sb1_table_shown <- single_beg1_df[, c(1, 2, 3, 7, 11, 10, 6, 8, 9)]

sb1_table_shown <- sb1_table_shown %>% arrange(desc(single_beg1_df$`High Score`), desc(single_beg1_df$`Accuracy Percentage`), single_beg1_df$`Average Time Taken per Round (sec)`, desc(single_beg1_df$`Number of Rounds Completed`), desc(single_beg1_df$`Score (cumulative)`), desc(single_beg1_df$`Average Score`), single_beg1_df$Date)

output$single_beg_1_high_score <- renderInfoBox({
  infoBox(
    "High Score", sb1_high_score, icon = icon("star"), color = "red", fill = TRUE, width = 3
  )
})

output$single_beg_1_fastest_time <- renderInfoBox({
  infoBox("Fastest Time Taken", sb1_fastest_time, icon = icon("clock"), color = "purple", fill = TRUE, width = 3
  )
})

output$single_beg_1_most_rounds <- renderInfoBox({
  infoBox(
    "Most Rounds Completed", sb1_most_rounds, icon = icon("check-square"), color = "yellow", fill = TRUE, width = 3
  )
})


# SECOND ROW
output$single_beg_1_average_score <- renderInfoBox({
  infoBox(
    "Average Score", sb1_average_score, icon = icon("balance-scale"), color = "blue", fill = TRUE
  )
})


output$single_beg_1_average_time <- renderInfoBox({
  infoBox("Average Time Taken", sb1_average_time, icon = icon("hourglass-half"), color = "olive", fill = TRUE
  )
})


output$single_beg_1_average_rounds <- renderInfoBox({
  infoBox(
    "Average Rounds Completed", sb1_average_rounds, icon = icon("gamepad"), color = "maroon", fill = TRUE
  )
})

# THIRD ROW
output$single_beg_1_best_accuracy <- renderInfoBox({
  infoBox(
    "Best Accuracy", paste(as.character(sb1_best_accuracy), "%"), icon = icon("bullseye"), color = "navy", fill = TRUE
  )
})

output$single_beg_1_average_accuracy <- renderInfoBox({
  infoBox(
    "Average Accuracy", paste(as.character(sb1_average_accuracy), "%"), icon = icon("dot-circle"), color = "navy", fill = TRUE
  )
})

# download data
output$single_beg_1_download_data <- renderInfoBox({
  infoBox(
    "Download Data", downloadButton("single_beg_1_download", "Download"), icon = icon("database"), color = "navy", fill = TRUE
  )
})
# download handler
output$single_beg_1_download <- downloadHandler(
  filename = function() {
    paste("Data - Single Beginner I", Sys.Date(), ".csv", sep = " ")
  },
  content = function(file) {
    write.csv(single_beg1_df, file)
  }
)

# TABLE
output$single_beg_1_table <- DT::renderDataTable(sb1_table_shown)



